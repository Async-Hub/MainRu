<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.8.6">Jekyll</generator><link href="/feed.xml" rel="self" type="application/atom+xml" /><link href="/" rel="alternate" type="text/html" /><updated>2020-04-13T17:02:31+04:00</updated><id>/feed.xml</id><title type="html">Программирование, облако и распределённые системы</title><subtitle>Разработка приложений на платформе Microsoft .NET Framework и не только.</subtitle><author><name>AsyncHub</name></author><entry><title type="html">Платформа ASP.NET Core 1.0. Часть 2: ASP.NET сегодня или что же выбрать?</title><link href="/2016/08/28/aspnet-core-1-0-part-1.html" rel="alternate" type="text/html" title="Платформа ASP.NET Core 1.0. Часть 2: ASP.NET сегодня или что же выбрать?" /><published>2016-08-28T21:07:22+04:00</published><updated>2016-08-28T21:07:22+04:00</updated><id>/2016/08/28/aspnet-core-1-0-part-1</id><content type="html" xml:base="/2016/08/28/aspnet-core-1-0-part-1.html">&lt;p&gt;На вопрос: «Microsoft ASP.NET vNext: эволюция или революция?» &lt;a href=&quot;http://www.msdr.ru/62/&quot;&gt;был дан однозначный ответ&lt;/a&gt; – революция. В данном цикле статей я постараюсь максимально подробно описать новейшую технологию для создания веб-приложений, а именно – ASP.NET vNext, которая в начале получила официальное название ASP.NET 5, а позднее была переименована в ASP.NET Core 1.0. Будет ещё один цикл, уже касающийся разработки реального приложения с примерами, посвящённый применению данной технологии на практике. Начну с описания истории развития ASP.NET. В далёком 1996 году компанией Microsoft была предложена технология – Active Server Pages (ASP) для создания Web-приложений. Принцип работы приложения ASP был примерно такой: веб-страница на сервере содержала серверные скрипты на VBScript или JScript и при запросе страницы происходил запуск и выполнение кода скриптов с последующей генерацией HTML. По сравнию с CGI это был большой шаг вперед. С выходом платформы Microsoft .NET Framework в 2002 году вышла совершенно новая платформа для разработки веб-приложений ASP.NET, которая была обновлена в 2003 году до версии ASP.NET 1.1. Именно тогда началась история ASP.NET. Это была совершенно новая, тогда ещё технология у которой было масса преимуществ перед ASP. По сути это был уже полноценный фреймворк для разработки веб-приложений. Время не стояло на месте, параллельно с развитием .NET Framework развивался и ASP.NET, в 2005 году было выпущено крупное обновление. Основными нововведениями были: темы, мастер-страницы, глобализация и т.п. Веб развивался быстрыми темпами, веб-страницы становились всё более интерактивными и насыщенными, появилась технология AJAX. В 2007 году было выпущено ещё одно крупное обновление – ASP.NET 3.5. Именно тогда появилась поддержка таких мощных средств как: ASP.NET AJAX, LINQ, Dynamic Data. С выпуском ASP.NET 3.5 SP1 в 2009 году был добавлен новый подход для обработки запросов веб-страниц на основе шаблона MVC. Теперь их стало целых два: Web Forms и MVC.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/2016-08-28-aspnet-core-1-0-part-1/A72I1.png&quot; alt=&quot;Image 1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Одновременно с запуском .NET Framework 4 была обновлена и ASP.NET до четвёртой версии. Ещё одно крупное обновление платформы было выпущено с выходом ASP.NET 4.5. Появились такие средства как Web API и SignalR. С выходом &lt;a href=&quot;http://www.msdr.ru/44/&quot;&gt;Visual Studio 2013&lt;/a&gt; появилась новая концепция – «Единый ASP.NET». Были обновлены все компоненты платформы, а также появилась новая спецификация &lt;a href=&quot;http://www.msdr.ru/52/&quot;&gt;OWIN – открытый интерфейс веб-сервера для .NET&lt;/a&gt; (Open Web Server Interface for .NET), которая стала основой ASP.NET vNext. А уже в прошлом году была выпущена предварительная версия кардинально переработанной технологии для разработки веб-приложений от Microsoft, которая получила официальное название – ASP.NET 5. Помимо прочего, также доступно очень большое количество обновленных и новых технологий и продуктов от Microsoft, финальные версии которых выйдут уже в этом году. А теперь обо всём этом по порядку. Начну с самого крупного и значимого события – обновления и улучшения .NET Framework. Прежде чем начать, вспомним историю развития .NET Framework:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/2016-08-28-aspnet-core-1-0-part-1/A72I2.png&quot; alt=&quot;Image 2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Платформа .NET была представлена в 2002 году и очень быстро завоевала популярность, став одной из основных современных средств разработки программного обеспечения. Её основными преумуществами перед предшественницей – технологией COM, которую она заменила, являются гибкость, более простая и надёжная модель программирования. Платформа равивалась, выходили всё новые версиии, библиотеки и технологии, для удовлетворения всё новых потребностей бысто развивающегося мира информационных технологий. Ну и конечно, Microsoft не сидит сложа руки, для того, чтобы идти в ногу со временем, продолжает улучшать платформу .NET. Совсем недавно платформа, представленная в прошлом году, была обновлена до версии .NET Framework 4.6.2. И так,  какое же будущее ожидает .NET? А будущее действительно очень интересное и многообещающее.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/2016-08-28-aspnet-core-1-0-part-1/A72I3.png&quot; alt=&quot;Image 3&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Как видно из рисунка показанного выше, есть по сути две версии .NET Framework. Первая является логическим продолжением существующей версии .NET 4.5.2, которая получила официальное название – .NET 4.6 (обновлённые версии: .NET Framework 4.6.1 – 4.6.2). Вторая именуется теперь уже как .NET Core 1.0 (до этого известная как .NET Core 5) и является упрощённой версией обычного .NET Framework. Если с первым всё предельно ясно и понятно, то в случае со вторым возникает много вопросов. Самый главный – зачем он нам? Для удовлетворения быстрорастущих потребностей современного цифрового мира, который развивается стремительными темпами. Если взглянуть на шкалу развития платформы .NET приведённую выше, то можно увидеть, что цикл выпуска новых версий платформы составляет примерно пару лет, а то и больше, что является очень большим сроком при нынешнем положении дел. Нужно как то исправить ситуацию,  решение – .NET Core 1.0. Последний должен удовлетворять современным требованиям разработки, для этого были установлены новые тентенции для продвижения и развития платформы: быстрый цикл разработки и участие сообщества. Для этих целей специально была создана независимая организация ­&lt;a href=&quot;http://www.dotnetfoundation.org/&quot;&gt;.NET Foundation­&lt;/a&gt;, которая будет заниматься развитием экосистемы .NET. По &lt;a href=&quot;http://www.dotnetfoundation.org/projects&quot;&gt;данной ссылке&lt;/a&gt; перечислены все текущие проекты, которые будут развиваться под руководством последней. То есть получается платформа .NET становится открытой. Полная модульность – вот одна из главнейших возможностей, которая мне нравится больше всех. Особенно это полезно для веб-приложений, позже напишу почему.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/2016-08-28-aspnet-core-1-0-part-1/A72I5.png&quot; alt=&quot;Image 4&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Следующий рисунок показывает общую модель приложения, которая будет использовать платформу .NET Core. Модульность .NET Core означает, что фреймворк будет поставляться по частям через NuGet, тогда можно будет вместе с приложением поставлять саму платформу, которая будет изолирована от остальных. Т.е. не будет одной общей версии .NET на всю машину.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/2016-08-28-aspnet-core-1-0-part-1/A72I6.png&quot; alt=&quot;Image 5&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Больше сведений про .NET 2015 и .NET Core можно узнать на &lt;a href=&quot;https://channel9.msdn.com/Events/dotnetConf/2015&quot;&gt;Channel 9&lt;/a&gt;. Также советую почитать &lt;a href=&quot;http://habrahabr.ru/company/microsoft/blog/245901/&quot;&gt;данную статью&lt;/a&gt; на хабре и &lt;a href=&quot;http://www.microsoftvirtualacademy.com/training-courses/the-development-of-modern-apps-in-c-sharp-rus&quot;&gt;изучить курс&lt;/a&gt; на сайте Microsoft Virtual Academy. А что нас ожидает в ближайшем будущем, каким будет .NET завтра?&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/2016-08-28-aspnet-core-1-0-part-1/A72I4.png&quot; alt=&quot;Image 6&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Больше сведений относительно настоящего и будущего платформы можно узнать из докладов &lt;a href=&quot;https://channel9.msdn.com/events/dotnetConf/2016/NET-Conf-Day-1-Keynote-Scott-Hunter&quot;&gt;dotnetConf 2016&lt;/a&gt;. Теперь, поговорим об ASP.NET Core, ниже показана изображение общей схемы платформы.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/2016-08-28-aspnet-core-1-0-part-1/A72I7.png&quot; alt=&quot;Image 7&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Как можно видеть из рисунка, ключевыми свойствами новой технологии являются полная модульность и кроссплатформенность. То есть используя фреймворк как часть пакета развёртывания, больше не будет проблем конфигурации среды хостинга для приложения. Каждое приложение будет иметь свою, независимую версию платформы. Почти вся платформа написана с нуля и на управляемом коде, старого кода тут нет. Весь исходный код новейшей версии веб-платформы &lt;a href=&quot;https://github.com/aspnet&quot;&gt;открыт и доступен&lt;/a&gt; на GiHub. Технологии ASP.NET MVC и Web API объеденены в одну, а Web Forms больше не используется в версии ASP.NET Core. Новая версия ASP.NET в ОС Windows будет работать используя одну из двух версий .NET Framework: .NET 4.6 и .NET Core 1.0. На Linux и Mac OS X будет использоваться только .NET Core. Больше сведений по ASP.NET Core можно получить на &lt;a href=&quot;https://channel9.msdn.com/Series/Whats-New-with-ASPNET-5&quot;&gt;Channel 9 ­«What’s ­New with ASP.NET 5»&lt;/a&gt;­, тот же &lt;a href=&quot;http://www.microsoftvirtualacademy.com/training-courses/what-s-new-with-asp-net-5&quot;&gt;курс доступен на сайте&lt;/a&gt; Microsoft Virtual Academy (ASP.NET 5 была переименована в ASP.NET Core 1.0).­­ Также советую посмотреть курс &lt;a href=&quot;https://app.pluralsight.com/library/courses/aspdotnet-core-1-0-fundamentals/table-of-contents&quot;&gt;«ASP.NET Core 1.0 Fundamentals»&lt;/a&gt; от Pluralsight. Много очень интересного и полезного для себя я почерпнул из доклада &lt;a href=&quot;https://www.techdays.ru/videos/11181.html&quot;&gt;«ASP.NET vNext: What it means to you and what it means to Microsoft»&lt;/a&gt;, который я пересмотрел не раз. В следующей части будет рассморено всё то, что предлагает нам новейшая версия .NET Framework в плане веб-разработки.&lt;/p&gt;</content><author><name>AsyncHub</name></author><summary type="html">На вопрос: «Microsoft ASP.NET vNext: эволюция или революция?» был дан однозначный ответ – революция. В данном цикле статей я постараюсь максимально подробно описать новейшую технологию для создания веб-приложений, а именно – ASP.NET vNext, которая в начале получила официальное название ASP.NET 5, а позднее была переименована в ASP.NET Core 1.0. Будет ещё один цикл, уже касающийся разработки реального приложения с примерами, посвящённый применению данной технологии на практике. Начну с описания истории развития ASP.NET. В далёком 1996 году компанией Microsoft была предложена технология – Active Server Pages (ASP) для создания Web-приложений. Принцип работы приложения ASP был примерно такой: веб-страница на сервере содержала серверные скрипты на VBScript или JScript и при запросе страницы происходил запуск и выполнение кода скриптов с последующей генерацией HTML. По сравнию с CGI это был большой шаг вперед. С выходом платформы Microsoft .NET Framework в 2002 году вышла совершенно новая платформа для разработки веб-приложений ASP.NET, которая была обновлена в 2003 году до версии ASP.NET 1.1. Именно тогда началась история ASP.NET. Это была совершенно новая, тогда ещё технология у которой было масса преимуществ перед ASP. По сути это был уже полноценный фреймворк для разработки веб-приложений. Время не стояло на месте, параллельно с развитием .NET Framework развивался и ASP.NET, в 2005 году было выпущено крупное обновление. Основными нововведениями были: темы, мастер-страницы, глобализация и т.п. Веб развивался быстрыми темпами, веб-страницы становились всё более интерактивными и насыщенными, появилась технология AJAX. В 2007 году было выпущено ещё одно крупное обновление – ASP.NET 3.5. Именно тогда появилась поддержка таких мощных средств как: ASP.NET AJAX, LINQ, Dynamic Data. С выпуском ASP.NET 3.5 SP1 в 2009 году был добавлен новый подход для обработки запросов веб-страниц на основе шаблона MVC. Теперь их стало целых два: Web Forms и MVC.</summary></entry><entry><title type="html">Microsoft OWIN и конвейер обработки запросов ASP.NET. Часть первая, общее описание конвейера IIS и ASP.NET до появления спецификации OWIN.</title><link href="/2014/12/23/microsoft-owin-and-aspnet-pipline-part-1.html" rel="alternate" type="text/html" title="Microsoft OWIN и конвейер обработки запросов ASP.NET. Часть первая, общее описание конвейера IIS и ASP.NET до появления спецификации OWIN." /><published>2014-12-23T17:19:22+04:00</published><updated>2014-12-23T17:19:22+04:00</updated><id>/2014/12/23/microsoft-owin-and-aspnet-pipline-part-1</id><content type="html" xml:base="/2014/12/23/microsoft-owin-and-aspnet-pipline-part-1.html">&lt;p&gt;Достаточно давно я хотел написать цикл статей про конвейер обработки запросов IIS и ASP.NET, но по причине отсутствия свободного времени никак не получалось. Ограничился лишь &lt;a href=&quot;http://www.msdr.ru/9/&quot;&gt;данными статьями&lt;/a&gt;. И вот такая возможность появилась. C выходом Visual Studio 2013 появилось много новшеств в ASP.NET. В частности таких как: единый ASP.NET и спецификация OWIN. О том какие преимущества даёт нам первая, было коротко написано в &lt;a href=&quot;http://www.msdr.ru/44/&quot;&gt;данной статье&lt;/a&gt;. Ну а обо всём остальном я расскажу далее. В этой статье я покажу весь конвейер IIS и ASP.NET, чтобы в других частях статей (про Microsoft OWIN) можно было бы использовать данную схему.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/2014-12-23-microsoft-owin-and-aspnet-pipline-part-1/IIS-and-ASP.NET-piplinev1.0.jpg&quot; alt=&quot;IIS-and-ASP.NET-pipline&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Когда я сам только начинал свой путь разработчика сильно нуждался в подобных наглядных схемах. Думаю, теперь это будет полезно другим. В следующих частях уже будет описана спецификация OWIN и всё что с этим связано в IIS и ASP.NET. &lt;a href=&quot;/assets/posts/2014-12-23-microsoft-owin-and-aspnet-pipline-part-1/IIS and ASP.NET pipline.pdf&quot;&gt;Вот ссылка на pdf файл&lt;/a&gt; высокого качества.&lt;/p&gt;</content><author><name>AsyncHub</name></author><summary type="html">Достаточно давно я хотел написать цикл статей про конвейер обработки запросов IIS и ASP.NET, но по причине отсутствия свободного времени никак не получалось. Ограничился лишь данными статьями. И вот такая возможность появилась. C выходом Visual Studio 2013 появилось много новшеств в ASP.NET. В частности таких как: единый ASP.NET и спецификация OWIN. О том какие преимущества даёт нам первая, было коротко написано в данной статье. Ну а обо всём остальном я расскажу далее. В этой статье я покажу весь конвейер IIS и ASP.NET, чтобы в других частях статей (про Microsoft OWIN) можно было бы использовать данную схему.</summary></entry><entry><title type="html">Microsoft OWIN и конвейер обработки запросов ASP.NET. Часть вторая, спецификация OWIN и его реализация компанией Microsoft. Проект Katana, общее описание.</title><link href="/2014/12/23/microsoft-owin-and-aspnet-pipline-part-2.html" rel="alternate" type="text/html" title="Microsoft OWIN и конвейер обработки запросов ASP.NET. Часть вторая, спецификация OWIN и его реализация компанией Microsoft. Проект Katana, общее описание." /><published>2014-12-23T17:19:22+04:00</published><updated>2014-12-23T17:19:22+04:00</updated><id>/2014/12/23/microsoft-owin-and-aspnet-pipline-part-2</id><content type="html" xml:base="/2014/12/23/microsoft-owin-and-aspnet-pipline-part-2.html">&lt;p&gt;OWIN – открытый интерфейс веб-сервера для .NET (Open Web Server Interface for .NET). Или говоря по другому – это спецификация определяющая абстакцию посредством которой взаимодействуют веб-сервер и веб-приложение. Более подробное описание спецификации можно найти на сайте &lt;a href=&quot;http://owin.org&quot;&gt;owin.org&lt;/a&gt;, а если более конкретно, то &lt;a href=&quot;http://http://owin.org/spec/spec/owin-1.0.0.html&quot;&gt;тут&lt;/a&gt;. Чтобы легче было себе представить, нужно взглянуть на рисунок приведённый ниже.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/2014-12-23-microsoft-owin-and-aspnet-pipline-part-2/2376.A50I1.jpg&quot; alt=&quot;Image 1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Правая диаграмма показывает общую схему структуры приложения, которое использует спецификацию OWIN для организации взаимодействия между компонентами всей инфраструктуры. Левая – схему структуры веб-приложений в Windows без использования этой спецификации, то есть то, что было раньше (есть и сейчас и будет в будущем). Если применить спецификацию OWIN  к связке IIS/ASP.NET, то получится примерно следующее.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/2014-12-23-microsoft-owin-and-aspnet-pipline-part-2/5367.A50I2.jpg&quot; alt=&quot;Image 2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Замечу сразу, что если быть более точным, то ни правая диаграмма первого рисунка и ни данная, в абсолютной точности не выражают схему организации структуры. Все дело в том, что нельзя просто так взять и отделить части схемы на независимые куски. Просто, на мой взгляд, для быстрого восприятия материала, они являются наиболее оптимальными для иллюстрации общей картины. Ну а дальше всё постепенно прояснится. Вернувшись к теме сразу возникает вопрос: а зачем лишний уровень абстракции и в без того &lt;a href=&quot;/2014-12-23-microsoft-owin-and-aspnet-pipline-part-1&quot;&gt;перегруженный конвейер&lt;/a&gt; IIS/ASP.NET ? Отвечу коротко – почти незачем, просто это одна из реализаций организации работы приложения по спецификации OWIN с использованием IIS/ASP.NET. Остальные выводы будут сделаны в конце статьи. В самом начале статьи упоминалось о взаимодействии сервера и приложения, на практике, такое взаимодействие сводится к использованию функций с сигнатурой одного единственного делегата, так называемого &lt;strong&gt;&lt;em&gt;делегата приложения&lt;/em&gt;&lt;/strong&gt;. Который имеет следующий вид:&lt;/p&gt;

&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;AppFunc&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IDictionary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Входной параметр имеющий тип &lt;strong&gt;IDictionary&amp;lt;string, object&amp;gt;&lt;/strong&gt; и называемый – &lt;em&gt;словарь окружения&lt;/em&gt;, содержит все данные (переменные сервера, данные запроса и т.п.). Он не может иметь значение &lt;strong&gt;null&lt;/strong&gt;, а так же быть пустым. Кроме того, должен содержать &lt;a href=&quot;http://owin.org/spec/spec/owin-1.0.0.html#_3.2._Environment&quot;&gt;некоторые ключи&lt;/a&gt; определённые спецификацией. Выходной параметр имеет тип &lt;strong&gt;Task&lt;/strong&gt; – инкапсулирует некоторую выполняемую задачу. На основе данного делегата строятся компонеты приложения и объединяются в цепочку, тем самым формируется конвейер обработки запросов OWIN, куда передаётся запрос на обработку. Из типа возвращаемого делегатом уже видно, что он будет работать в асинхронном режиме. Пока, всё описанное выше – это только теория. Microsft OWIN или проект под названием &lt;strong&gt;Katana&lt;/strong&gt; является реализацией спецификации OWIN компанией Microsoft. Исходный код проекта полность открытый и находится на CodePlex по &lt;a href=&quot;https://katanaproject.codeplex.com/&quot;&gt;следующему адресу&lt;/a&gt;. На момент написания статьи текущая версия 3.0.0 Alpha, а RTM версия – 2.1.0. Именно последняя будет описана и использоваться в дальнейшем. Ниже представлена визуальная схема архитектуры проекта Katana, &lt;a href=&quot;http://owin.org/spec/spec/owin-1.0.0.html&quot;&gt;согласно спецификации&lt;/a&gt; OWIN.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/2014-12-23-microsoft-owin-and-aspnet-pipline-part-2/2626.A50I3.jpg&quot; alt=&quot;Image 3&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Если скачать и открыть проект, то можно увидеть, что примерно так всё и выглядит.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/2014-12-23-microsoft-owin-and-aspnet-pipline-part-2/1452.A50I4.jpg&quot; alt=&quot;Image 4&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Ниже представлены схематические изображения архитектуры веб-приложений использующих Katana и работающих по спецификации OWIN.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/2014-12-23-microsoft-owin-and-aspnet-pipline-part-2/2248.A50I5.jpg&quot; alt=&quot;Image 5&quot; /&gt;&lt;/p&gt;

&lt;p&gt;И так, что же означает абреввиатура OWIN показанная на диаграммах как промежуточный слой. Это основное связующее звено в приложении, того самого промежуточного слоя, представленное в виде единственного интерфейса &lt;strong&gt;IAppBuilder&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Owin&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;System.Collections.Generic&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IAppBuilder&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Build&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;returnType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;IAppBuilder&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;IAppBuilder&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Use&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;middleware&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 
        &lt;span class=&quot;n&quot;&gt;IDictionary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Properties&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Интерфейс не является частью спецификации. Тут есть очень тонкий момент: вся инфраструктура работает по спецификации OWIN, а данная абреввиатура на диаграммах, наглядно показывает просто конкретную реализацию промежуточного слоя. Теперь, чтобы лучше понять материал я покажу как создать очень простое веб-приложение, которое будет работать по спецификации OWIN. Для начала нам нужен хост, процесс в Windows в котором будет работать наше приложение. Для этого создадим простое консольное приложение в Visual Studio 2013.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/2014-12-23-microsoft-owin-and-aspnet-pipline-part-2/6886.A50I6.jpg&quot; alt=&quot;Image 6&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Естественно, реализация спецификации OWIN задача ресурсоёмкая, поэтому и есть проект Katana. Воспользуемся некоторыми готовыми компонентами Katana, установив их через NuGet.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/2014-12-23-microsoft-owin-and-aspnet-pipline-part-2/8540.A50I7.jpg&quot; alt=&quot;Image 7&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Как видно из рисунка выше, было установлено четыре сборки. Сборка OWIN, содержит один едниственный интерфейс – IAppBuilder, который был описан выше. Microsoft.Owin – содержит множество вспомагательных типов, которые облегчают создание разных  компонетов Owin. Например: OwinRequest, OwinResponse, OwinContext и т.д. Сборка Microsoft.Owin.Hosting содержит типы необходимые для хостинга и запуска приложения. Ну а сборка Microsoft.Owin.Host.HttpListener содержит дефолтовый сервер OwinHttpListener проекта Katana. Это по сути обёртка вокруг стандартного System.Net.HttpListener. Для конфигурации приложения при запуске, Katana ищет класс Startup. В качестве шаблонного элемента он присутсвует в Visual Studio 2013. Добавим его. Более подробно об алгоритме поиска класса Startup написано &lt;a href=&quot;http://www.asp.net/aspnet/overview/owin-and-katana/owin-startup-class-detection&quot;&gt;тут&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/2014-12-23-microsoft-owin-and-aspnet-pipline-part-2/3750.A50I8.jpg&quot; alt=&quot;Image8&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Осталось добавить код, запускающий сервер:&lt;/p&gt;

&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Microsoft.Owin.Hosting&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
&lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;SimpleOwinApplication&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Program&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uri&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;http://localhost:8088/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
            &lt;span class=&quot;k&quot;&gt;using&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;WebApp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Startup&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;Console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;WriteLine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Server started&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;Console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;Console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;WriteLine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Server stoped&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;и код конфигурации.&lt;/p&gt;

&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Owin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Microsoft.Owin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 
&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;assembly&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;OwinStartup&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;typeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SimpleOwinApplication&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Startup&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))]&lt;/span&gt;
 
&lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;SimpleOwinApplication&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Startup&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Configuration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IAppBuilder&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ContentType&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;text/html&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;WriteAsync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;htmlText&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
 
        &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;htmlText&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;lt;html&amp;gt;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt;
                                          &lt;span class=&quot;s&quot;&gt;&quot;&amp;lt;head&amp;gt;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt;
                                              &lt;span class=&quot;s&quot;&gt;&quot;&amp;lt;title&amp;gt;&amp;lt;/title&amp;gt;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt;
                                          &lt;span class=&quot;s&quot;&gt;&quot;&amp;lt;/head&amp;gt;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt;
                                          &lt;span class=&quot;s&quot;&gt;&quot;&amp;lt;body&amp;gt;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt;
                                              &lt;span class=&quot;s&quot;&gt;&quot;&amp;lt;h1&amp;gt;Simple Owin Application&amp;lt;h1&amp;gt;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt;
                                          &lt;span class=&quot;s&quot;&gt;&quot;&amp;lt;/body&amp;gt;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt;
                                        &lt;span class=&quot;s&quot;&gt;&quot;&amp;lt;/html&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ничего особенного тут не происходит. Просто на все запросы к хосту, сервет отвечает куском кода HTML. В следующей части все детали конвейера OWIN и его компоненты будут расмотрены более детально.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/2014-12-23-microsoft-owin-and-aspnet-pipline-part-2/4520.A50I9.jpg&quot; alt=&quot;Image9&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Запускаем приложение, и видим что всё работает. Здесь находится &lt;a href=&quot;http://www.msdr.ru/files/SimpleOwinApplication.zip&quot;&gt;ссылка на проект&lt;/a&gt;. Тут уже назревает вопрос: зачем нам всё это, плохо ли было без этого? Конечно нет, но если посмотреть с другой стороны, то инфраструктура веб-приложения построенная по спецификации OWIN при помощи управляемого кода даёт нам полную свободу действий и гибкость, еcли мы реализуем её без использования существующей. То есть, если мы не используем IIS/ASP.NET. Лично я не вижу смысла использовать спецификацию OWIN в приложениях IIS/ASP.NET, об этом будет ещё написано в следующих статьях. Почему не стоит? Да потому, что конвейер IIS/ASP.NET и &lt;a href=&quot;/2014/12/23/microsoft-owin-and-aspnet-pipline-part-1.html&quot;&gt;без того перегружен&lt;/a&gt;. Незачем вводить ещё один дополнительный слой абстракции. И к тому же технология ASP.NET достаточно зрелая и используя накопленные возможности и опыт можно решить очень широкий круг задач, что мы и делали до сих пор и будем делать. Вывод – спецификация OWIN позволяет пересмотреть  архитектуру веб-инфраструктуры не принося ничего нового в уже существующую, но позволяющая построить совершенно новую и полностью управляемую архитектуру инфраструктуры.&lt;/p&gt;</content><author><name>AsyncHub</name></author><summary type="html">OWIN – открытый интерфейс веб-сервера для .NET (Open Web Server Interface for .NET). Или говоря по другому – это спецификация определяющая абстакцию посредством которой взаимодействуют веб-сервер и веб-приложение. Более подробное описание спецификации можно найти на сайте owin.org, а если более конкретно, то тут. Чтобы легче было себе представить, нужно взглянуть на рисунок приведённый ниже.</summary></entry></feed>